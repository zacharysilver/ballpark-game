'use client';

import React, { useEffect, useState } from "react";
import {
    ComposableMap,
    Geographies,
    Geography,
    Annotation,
    ZoomableGroup, Marker
} from "react-simple-maps";
import Popup from "reactjs-popup";
import logos from "@/app/logos";
import stadiumsOrig from "@/constants/ballparkList.json";
const stadiums = stadiumsOrig.sort((a, b) => a.team.localeCompare(b.team));
const geoUrl = "https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json";

interface Stadium {
    team: string;
    address: string;
    lat: number;
    lng: number;
}
const MLBBallparkMap = () => {
    const [selectedStadium, setSelectedStadium] = useState<Stadium|null>(null);

    const handleClick = (e: Stadium) => {
        setSelectedStadium(e);
    }

    return (
        <div className="relative w-full h-[600px]">
            <ComposableMap projection="geoAlbersUsa">
                <Geographies geography={geoUrl}>
                    {({ geographies }) =>
                        geographies.map(geo => (
                            <Geography
                                key={geo.rsmKey}
                                geography={geo}
                                fill="#EAEAEC"
                                stroke="#D6D6DA"

                            />
                        ))
                    }
                </Geographies>
                {stadiums.map((stadium, index) => {

                    return (
                        <Marker enableBackground={"white"} key={index} coordinates={[stadium.lng - .5, stadium.lat + .5]} onClick={() => { handleClick(stadium) }}>
                            {React.createElement(logos[index], { size: 20 })}


                        </Marker>


                    );
                })}

            </ComposableMap>
            {selectedStadium && (
                <Popup open={true} closeOnDocumentClick onClose={() => { setSelectedStadium(null) }}>
                    <div className="w-[300px] h-[300px]">
                        <h2>{selectedStadium.team}</h2>
                        <p>hello</p>
                    </div></Popup>)
            }
        </div>

    );
};

export default MLBBallparkMap;

